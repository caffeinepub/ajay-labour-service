{
  "kind": "build_request",
  "title": "Configure logged-in user as super admin with full access rights",
  "priority": "high",
  "requirements": [
    {
      "id": "REQ-47",
      "text": "Update backend main.mo to capture the caller's principal from the current authenticated Internet Identity session and grant super admin role with full access rights",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-latest"
        ],
        "quotes": [
          "i have logged in . set this identity as super admin."
        ]
      },
      "acceptanceCriteria": [
        "The isCallerAdmin method returns true for the configured super admin principal",
        "Super admin principal is persisted in stable storage across canister upgrades",
        "Only the super admin principal can access all admin dashboard features without restrictions"
      ]
    },
    {
      "id": "REQ-48",
      "text": "Add a backend method to set or update the super admin principal that can only be called once during initial setup or by the current super admin",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-latest"
        ]
      },
      "acceptanceCriteria": [
        "Method validates that caller is either setting initial super admin (when none exists) or is the current super admin",
        "Returns success confirmation when super admin is successfully configured",
        "Returns descriptive error if unauthorized principal attempts to set super admin"
      ]
    },
    {
      "id": "REQ-49",
      "text": "Update frontend AdminGuard component to handle super admin authentication flow and display appropriate messaging when super admin access is granted",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-latest"
        ]
      },
      "acceptanceCriteria": [
        "Component correctly identifies when logged-in user is the super admin",
        "Admin dashboard becomes accessible immediately after super admin authentication",
        "No access denied message appears for the super admin principal"
      ]
    },
    {
      "id": "REQ-50",
      "text": "Add console logging throughout the super admin configuration process to capture principal IDs, authentication status, and any authorization failures for debugging",
      "target": "both",
      "source": {
        "messageIds": [
          "msg-latest"
        ]
      },
      "acceptanceCriteria": [
        "Backend logs show the principal being configured as super admin",
        "Frontend logs display the authenticated principal and admin check results",
        "Error logs provide clear information if super admin setup fails"
      ]
    }
  ],
  "constraints": [
    "Maintain single-actor architecture with all logic in backend/main.mo",
    "Use existing Internet Identity authentication system - do not modify useInternetIdentity.ts",
    "Preserve existing role-based access control structure",
    "Do not create email-based authentication system"
  ],
  "nonGoals": [
    "Implementing email/password login system",
    "Creating multiple admin roles beyond super admin",
    "Building admin user management interface",
    "Modifying Internet Identity authentication flow"
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}